---
title: "LOGISTIC FIT"
author: "Victor M. Uribe"
date: "2023-01-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(tidymodels)
```










# Logistic Regression
```{r}
log_spec <- logistic_reg() %>% 
  set_engine("glm")

log_rec <- recipe(success ~., everest_train) %>% 
  step_normalize(all_numeric_predictors())

log_wf <- workflow() %>% 
  add_model(log_spec) %>% 
  add_recipe(log_rec)
```


```{r}
doParallel::registerDoParallel()

log_fit <- log_wf %>% 
  fit(everest_train)

log_pred <- log_fit %>% 
  predict(everest_test)  

tmp <- factor(ifelse(log_pred == TRUE, TRUE, FALSE)) 
caret::confusionMatrix(tmp, everest_test[["success"]])
```
























